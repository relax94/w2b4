{"version":3,"sources":["../../jsnn/draw.js"],"names":["gridData","data","Array","xpos","ypos","width","height","click","row","push","column","x","y","console","log","grid","d3","select","append","attr","selectAll","enter","d","style","on","trainSet","trainExample","getTrainExample","_groups","forEach","sq","rect","document","getElementById","addEventListener","clearOutputList","elm","hasChildNodes","removeChild","lastChild","$","ajax","type","url","success","max","Math","i","el","createElement","innerText","backgroundColor","dataType","mousePressed","lastX","lastY","ctx","InitThis","getContext","mousedown","e","Draw","pageX","offset","left","pageY","top","mousemove","mouseup","mouseleave","isDown","beginPath","strokeStyle","val","lineWidth","lineJoin","moveTo","lineTo","closePath","stroke","trainSingleEpochExample","answer","value","pixelsArr","imageData","getImageData","reduce","prev","next","setTransform","clearRect","canvas","set","JSON","stringify","clearArea"],"mappings":"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","file":"draw.js","sourcesContent":["function gridData() {\r\n    var data = new Array();\r\n    var xpos = 1; //starting xpos and ypos at 1 so the stroke will show when we make the grid below\r\n    var ypos = 1;\r\n    var width = 50;\r\n    var height = 50;\r\n    var click = 0;\r\n\r\n    // iterate for rows\t\r\n    for (var row = 0; row < 5; row++) {\r\n        data.push(new Array());\r\n\r\n        // iterate for cells/columns inside rows\r\n        for (var column = 0; column < 3; column++) {\r\n            data[row].push({\r\n                x: xpos,\r\n                y: ypos,\r\n                width: width,\r\n                height: height,\r\n                click: click\r\n            })\r\n            // increment the x position. I.e. move it over by 50 (width variable)\r\n            xpos += width;\r\n        }\r\n        // reset the x position after a row is complete\r\n        xpos = 1;\r\n        // increment the y position for the next row. Move it down 50 (height variable)\r\n        ypos += height;\r\n    }\r\n    return data;\r\n}\r\n\r\nvar gridData = gridData();\r\n// I like to log the data to the console for quick debugging\r\nconsole.log(gridData);\r\n\r\nvar grid = d3.select(\"#grid\")\r\n    .append(\"svg\")\r\n    .attr(\"width\", \"152px\")\r\n    .attr(\"height\", \"252px\");\r\n\r\nvar row = grid.selectAll(\".row\")\r\n    .data(gridData)\r\n    .enter().append(\"g\")\r\n    .attr(\"class\", \"row\");\r\n\r\nvar column = row.selectAll(\".square\")\r\n    .data(function (d) { return d; })\r\n    .enter().append(\"rect\")\r\n    .attr(\"class\", \"square\")\r\n    .attr(\"x\", function (d) { return d.x; })\r\n    .attr(\"y\", function (d) { return d.y; })\r\n    .attr(\"width\", function (d) { return d.width; })\r\n    .attr(\"height\", function (d) { return d.height; })\r\n    .style(\"stroke\", \"#222\")\r\n    .on('click', function (d) {\r\n        d.click++;\r\n        if (d.click == 1) {\r\n            d3.select(this).style(\"fill\", \"#2C93E8\");\r\n            d3.select(this).attr(\"fill\", true);\r\n        }\r\n        if (d.click == 2) {\r\n            d3.select(this).style(\"fill\", \"#000\");\r\n            d3.select(this).attr(\"fill\", null);\r\n            d.click = 0;\r\n        }\r\n        //    if ((d.click)%4 == 3 ) { d3.select(this).style(\"fill\",\"#838690\"); }\r\n    });\r\n\r\nvar trainSet = {};\r\n\r\n\r\nvar trainExample = [];\r\nfunction getTrainExample(){\r\n    row.selectAll(\".square\")._groups.forEach((sq) => {\r\n        sq.forEach((rect) => {\r\n            trainExample.push(d3.select(rect).attr(\"fill\") ? 1 : 0);\r\n        });\r\n    });\r\n}\r\n\r\n/*\r\ndocument.getElementById('train').addEventListener('click', function () {\r\n\r\n});\r\n*/\r\n\r\n\r\ndocument.getElementById('apply').addEventListener('click', function () {\r\n    clearOutputList();\r\n    trainExample = [];\r\n    getTrainExample();\r\n});\r\n\r\nfunction clearOutputList(){\r\n    var elm = document.getElementById('output-results');\r\n    while (elm.hasChildNodes()) {\r\n        elm.removeChild(elm.lastChild);\r\n    }\r\n}\r\n\r\ndocument.getElementById('recognize').addEventListener('click', function () {\r\n    $.ajax({\r\n        type: \"POST\",\r\n        url: 'http://localhost:4343/network/games/image',\r\n        data: { data: trainExample },\r\n        success: (success) => {\r\n            var max = Math.max(...success);\r\n            for(var i in success) {\r\n                var el = document.createElement('div');\r\n                el.innerText = i + \"  ---- >  \" +success[i];\r\n\r\n                if(success[i] == max)\r\n                    el.style.backgroundColor = \"green\";\r\n                document.getElementById('output-results').append(el);\r\n            }\r\n        },\r\n        dataType: 'json'\r\n    });\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar mousePressed = false;\r\nvar lastX, lastY;\r\nvar ctx;\r\n\r\nfunction InitThis() {\r\n    ctx = document.getElementById('myCanvas').getContext(\"2d\");\r\n\r\n    $('#myCanvas').mousedown(function (e) {\r\n        mousePressed = true;\r\n        Draw(e.pageX - $(this).offset().left, e.pageY - $(this).offset().top, false);\r\n    });\r\n\r\n    $('#myCanvas').mousemove(function (e) {\r\n        if (mousePressed) {\r\n            Draw(e.pageX - $(this).offset().left, e.pageY - $(this).offset().top, true);\r\n        }\r\n    });\r\n\r\n    $('#myCanvas').mouseup(function (e) {\r\n        mousePressed = false;\r\n    });\r\n    $('#myCanvas').mouseleave(function (e) {\r\n        mousePressed = false;\r\n    });\r\n}\r\n\r\nfunction Draw(x, y, isDown) {\r\n    if (isDown) {\r\n        ctx.beginPath();\r\n        ctx.strokeStyle = $('#selColor').val();\r\n        ctx.lineWidth = $('#selWidth').val();\r\n        ctx.lineJoin = \"round\";\r\n        ctx.moveTo(lastX, lastY);\r\n        ctx.lineTo(x, y);\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n    }\r\n    lastX = x; lastY = y;\r\n}\r\n\r\nvar trainSingleEpochExample = [];\r\ndocument.getElementById('addExample').addEventListener('click', function () {\r\n    var answer = document.getElementById('answer').value;\r\n\r\n    var pixelsArr = [];\r\n\r\n    var imageData = ctx.getImageData(0, 0, 25, 25).data;\r\n    //var imageData = [1,2,2,1,2,3,4,1,1,3,4,1,2,3,4,5];\r\n    imageData.reduce((prev, next, i) => {\r\n        prev += next;\r\n        if((i + 1) % 4 === 0){\r\n            pixelsArr.push(prev);\r\n            prev = 0;\r\n        }\r\n        return prev;\r\n    },0);\r\n\r\n/*for(var i = 0; i < imageData.length; i+=4) {\r\n    var r = imageData[i];\r\n    var g = imageData[i + 1];\r\n    var b = imageData[i + 2];\r\n\r\n    var rgb = r + g + b;\r\n    pixelsArr.push(rgb);\r\n}*/\r\n\r\n    //trainSingleEpochExample[answer] = pixelsArr;\r\n    trainSingleEpochExample.push(pixelsArr);\r\n    console.log(trainSingleEpochExample);\r\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\r\n    ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n\r\n});\r\n\r\n\r\ndocument.getElementById('recognizeHandwrite').addEventListener('click', function () {\r\n    var pixelsArr = [];\r\n\r\n    var imageData = ctx.getImageData(0, 0, 25, 25).data;\r\n    //var imageData = [1,2,2,1,2,3,4,1,1,3,4,1,2,3,4,5];\r\n    imageData.reduce((prev, next, i) => {\r\n        prev += next;\r\n        if((i + 1) % 4 === 0){\r\n            pixelsArr.push(prev);\r\n            prev = 0;\r\n        }\r\n        return prev;\r\n    },0);\r\n\r\n    console.log('hnd rec ', pixelsArr);\r\n    //trainSingleEpochExample[answer] = pixelsArr;\r\n    $.ajax({\r\n        type: \"POST\",\r\n        url: 'http://localhost:4343/network/games/image',\r\n        data: { data: pixelsArr },\r\n        success: (success) => {\r\n            var max = Math.max(...success);\r\n            for(var i in success) {\r\n                var el = document.createElement('div');\r\n                el.innerText = i + \"  ---- >  \" +success[i];\r\n\r\n                if(success[i] == max)\r\n                    el.style.backgroundColor = \"green\";\r\n                document.getElementById('output-results').append(el);\r\n            }\r\n        },\r\n        dataType: 'json'\r\n    });\r\n});\r\n\r\n\r\ndocument.getElementById('trainNetwork').addEventListener('click', function () {\r\n\r\n    $.ajax({\r\n        type: \"POST\",\r\n        url: 'http://localhost:4343/network/games/train',\r\n        data: { set :  JSON.stringify(trainSingleEpochExample)},\r\n        success: (success) => {\r\n\r\n        },\r\n        dataType: 'json'\r\n    });\r\n});\r\n\r\nfunction clearArea() {\r\n    // Use the identity matrix while clearing the canvas\r\n\r\n\r\n}"]}